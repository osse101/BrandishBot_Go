level=warning msg="[config_reader] The configuration option `run.skip-dirs` is deprecated, please use `issues.exclude-dirs`."
level=warning msg="[config_reader] The configuration option `output.format` is deprecated, please use `output.formats`"
internal/progression/voting_sessions.go:324:27: Error return value of `s.CheckAndUnlockNode` is not checked (errcheck)
						s.CheckAndUnlockNode(s.shutdownCtx)
						                    ^
internal/progression/voting_sessions.go:20:1: cyclomatic complexity 24 of func `(*service).StartVotingSession` is high (> 15) (gocyclo)
func (s *service) StartVotingSession(ctx context.Context, unlockedNodeID *int) error {
^
internal/progression/tree_loader.go:198:1: cyclomatic complexity 24 of func `(*treeLoader).SyncToDatabase` is high (> 15) (gocyclo)
func (t *treeLoader) SyncToDatabase(ctx context.Context, config *TreeConfig, repo Repository) (*SyncResult, error) {
^
internal/progression/voting_sessions.go:167:1: cyclomatic complexity 18 of func `(*service).EndVoting` is high (> 15) (gocyclo)
func (s *service) EndVoting(ctx context.Context) (*domain.ProgressionVotingOption, error) {
^
internal/progression/tree_loader.go:89:1: cyclomatic complexity 16 of func `(*treeLoader).Validate` is high (> 15) (gocyclo)
func (t *treeLoader) Validate(config *TreeConfig) error {
^
cmd/debug/main.go:14:1: cyclomatic complexity 24 of func `main` is high (> 15) (gocyclo)
func main() {
^
internal/event/resilient_publisher.go:68:23: Error return value of `rp.deadLetter.Write` is not checked (errcheck)
			rp.deadLetter.Write(event, 0, err)
			                   ^
internal/event/resilient_publisher.go:105:23: Error return value of `rp.deadLetter.Write` is not checked (errcheck)
			rp.deadLetter.Write(entry.event, entry.attempt, err)
			                   ^
internal/event/resilient_publisher.go:121:25: Error return value of `rp.deadLetter.Write` is not checked (errcheck)
					rp.deadLetter.Write(nextEntry.event, nextEntry.attempt, nextEntry.lastError)
					                   ^
internal/event/resilient_publisher.go:146:24: Error return value of `rp.deadLetter.Write` is not checked (errcheck)
				rp.deadLetter.Write(entry.event, entry.attempt, err)
				                   ^
internal/discord/client.go:402: 402-427 lines are duplicate of `internal/discord/client.go:464-489` (dupl)
func (c *APIClient) AdminInstantUnlock() (string, error) {
	resp, err := c.doRequest(http.MethodPost, "/api/v1/progression/admin/instant-unlock", nil)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var instantResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&instantResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return instantResp.Message, nil
}
internal/discord/client.go:464: 464-489 lines are duplicate of `internal/discord/client.go:492-517` (dupl)
func (c *APIClient) AdminReloadWeights() (string, error) {
	resp, err := c.doRequest(http.MethodPost, "/api/admin/progression/reload-weights", nil)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var reloadResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&reloadResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return reloadResp.Message, nil
}
internal/discord/client.go:492: 492-517 lines are duplicate of `internal/discord/client.go:520-545` (dupl)
func (c *APIClient) AdminStartVoting() (string, error) {
	resp, err := c.doRequest(http.MethodPost, "/api/v1/progression/admin/start-voting", nil)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var startResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&startResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return startResp.Message, nil
}
internal/discord/client.go:520: 520-545 lines are duplicate of `internal/discord/client.go:402-427` (dupl)
func (c *APIClient) AdminEndVoting() (string, error) {
	resp, err := c.doRequest(http.MethodPost, "/api/v1/progression/admin/end-voting", nil)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var endResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&endResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return endResp.Message, nil
}
internal/discord/client.go:301: 301-333 lines are duplicate of `internal/discord/client.go:704-736` (dupl)
func (c *APIClient) VoteForNode(platform, platformID, username, nodeKey string) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"node_key":    nodeKey,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/progression/vote", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var voteResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&voteResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return voteResp.Message, nil
}
internal/discord/client.go:704: 704-736 lines are duplicate of `internal/discord/client.go:739-771` (dupl)
func (c *APIClient) AddItemByUsername(platform, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":  platform,
		"username":  username,
		"item_name": itemName,
		"quantity":  quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/add-by-username", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var result struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&result); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return result.Message, nil
}
internal/discord/client.go:739: 739-771 lines are duplicate of `internal/discord/client.go:301-333` (dupl)
func (c *APIClient) RemoveItemByUsername(platform, username, itemName string, quantity int) (int, error) {
	req := map[string]interface{}{
		"platform":  platform,
		"username":  username,
		"item_name": itemName,
		"quantity":  quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/remove-by-username", req)
	if err != nil {
		return 0, err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return 0, fmt.Errorf("API error: %s", errResp.Error)
		}
		return 0, fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var result struct {
		Removed int `json:"removed"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&result); err != nil {
		return 0, fmt.Errorf("failed to decode response: %w", err)
	}

	return result.Removed, nil
}
internal/discord/client.go:570: 570-639 lines are duplicate of `internal/discord/client.go:849-918` (dupl)
func (c *APIClient) BuyItem(platform, platformID, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"item_name":   itemName,
		"quantity":    quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/buy", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var buyResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&buyResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return buyResp.Message, nil
}

// SellItem sells an item from inventory
func (c *APIClient) SellItem(platform, platformID, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"item_name":   itemName,
		"quantity":    quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/sell", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var sellResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&sellResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return sellResp.Message, nil
}
internal/discord/client.go:849: 849-918 lines are duplicate of `internal/discord/client.go:570-639` (dupl)
func (c *APIClient) UpgradeItem(platform, platformID, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"item":        itemName,
		"quantity":    quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/upgrade", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var upgradeResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&upgradeResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return upgradeResp.Message, nil
}

// DisassembleItem breaks down an item for materials
func (c *APIClient) DisassembleItem(platform, platformID, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"item_name":   itemName,
		"quantity":    quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/disassemble", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var disassembleResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&disassembleResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return disassembleResp.Message, nil
}
internal/discord/cmd_progression_extended.go:242: 242-285 lines are duplicate of `internal/discord/cmd_progression_extended.go:288-331` (dupl)
func AdminStartVotingCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:                     "admin-start-voting",
		Description:              "[Admin] Start a new voting session",
		DefaultMemberPermissions: &[]int64{discordgo.PermissionAdministrator}[0],
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.AdminStartVoting()
		if err != nil {
			errorMsg := fmt.Sprintf("âŒ Failed to start voting: %v", err)
			if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
				Content: &errorMsg,
			}); err != nil {
				slog.Error("Failed to send error response", "error", err)
			}
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ—³ï¸ Admin Start Voting",
			Description: msg,
			Color:       0x9B59B6, // Purple
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot Admin",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to edit interaction response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_progression_extended.go:288: 288-331 lines are duplicate of `internal/discord/cmd_progression_extended.go:391-434` (dupl)
func AdminEndVotingCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:                     "admin-end-voting",
		Description:              "[Admin] End current voting session",
		DefaultMemberPermissions: &[]int64{discordgo.PermissionAdministrator}[0],
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.AdminEndVoting()
		if err != nil {
			errorMsg := fmt.Sprintf("âŒ Failed to end voting: %v", err)
			if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
				Content: &errorMsg,
			}); err != nil {
				slog.Error("Failed to send error response", "error", err)
			}
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ›‘ Admin End Voting",
			Description: msg,
			Color:       0x9B59B6, // Purple
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot Admin",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to edit interaction response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_progression_extended.go:391: 391-434 lines are duplicate of `internal/discord/cmd_progression_extended.go:242-285` (dupl)
func AdminReloadWeightsCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:                     "admin-reload-weights",
		Description:              "[Admin] Reload engagement weight cache",
		DefaultMemberPermissions: &[]int64{discordgo.PermissionAdministrator}[0],
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.AdminReloadWeights()
		if err != nil {
			errorMsg := fmt.Sprintf("âŒ Failed to reload weights: %v", err)
			if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
				Content: &errorMsg,
			}); err != nil {
				slog.Error("Failed to send error response", "error", err)
			}
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ”„ Engagement Weights Reloaded",
			Description: msg,
			Color:       0x3498db, // Blue
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot Admin",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to edit interaction response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/client_link.go:30: 30-52 lines are duplicate of `internal/discord/client_link.go:81-103` (dupl)
func (c *APIClient) InitiateLink(discordID string) (*LinkInitiateResult, error) {
	req := map[string]string{
		"platform":    domain.PlatformDiscord,
		"platform_id": discordID,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/link/initiate", req)
	if err != nil {
		return nil, err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		return nil, fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var result LinkInitiateResult
	if err := json.NewDecoder(resp.Body).Decode(&result); err != nil {
		return nil, fmt.Errorf("failed to decode response: %w", err)
	}

	return &result, nil
}
internal/discord/client_link.go:81: 81-103 lines are duplicate of `internal/discord/client_link.go:30-52` (dupl)
func (c *APIClient) ConfirmLink(discordID string) (*LinkConfirmResult, error) {
	req := map[string]string{
		"platform":    domain.PlatformDiscord,
		"platform_id": discordID,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/link/confirm", req)
	if err != nil {
		return nil, err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		return nil, fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var result LinkConfirmResult
	if err := json.NewDecoder(resp.Body).Decode(&result); err != nil {
		return nil, fmt.Errorf("failed to decode response: %w", err)
	}

	return &result, nil
}
internal/discord/cmd_crafting.go:12: 12-87 lines are duplicate of `internal/discord/cmd_crafting.go:90-163` (dupl)
func UpgradeCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:        "upgrade",
		Description: "Craft an item upgrade using a recipe",
		Options: []*discordgo.ApplicationCommandOption{
			{
				Type:         discordgo.ApplicationCommandOptionString,
				Name:         "recipe",
				Description:  "Recipe/Item to craft (start typing to search)",
				Required:     true,
				Autocomplete: true,
			},
			{
				Type:        discordgo.ApplicationCommandOptionInteger,
				Name:        "quantity",
				Description: "Quantity to craft (default: 1)",
				Required:    false,
			},
		},
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		user := i.Member.User
		if user == nil {
			user = i.User
		}

		options := i.ApplicationCommandData().Options
		itemName := options[0].StringValue()
		quantity := 1
		if len(options) > 1 {
			quantity = int(options[1].IntValue())
		}

		// Ensure user exists
		_, err := client.RegisterUser(user.Username, user.ID)
		if err != nil {
			slog.Error("Failed to register user", "error", err)
			respondError(s, i, "Error connecting to game server.")
			return
		}

		// Note: We now pass itemName instead of recipeID
		// The autocomplete value is the item name
		msg, err := client.UpgradeItem(domain.PlatformDiscord, user.ID, user.Username, itemName, quantity)
		if err != nil {
			slog.Error("Failed to upgrade item", "error", err)
			respondFriendlyError(s, i, err.Error())
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ”¨ Upgrade Complete",
			Description: msg,
			Color:       0xe67e22, // Orange
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_crafting.go:90: 90-163 lines are duplicate of `internal/discord/cmd_economy.go:12-85` (dupl)
func DisassembleCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:        "disassemble",
		Description: "Break down an item to get materials",
		Options: []*discordgo.ApplicationCommandOption{
			{
				Type:         discordgo.ApplicationCommandOptionString,
				Name:         "item",
				Description:  "Item name to disassemble",
				Required:     true,
				Autocomplete: true,
			},
			{
				Type:        discordgo.ApplicationCommandOptionInteger,
				Name:        "quantity",
				Description: "Quantity to disassemble (default: 1)",
				Required:    false,
			},
		},
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		user := i.Member.User
		if user == nil {
			user = i.User
		}

		options := i.ApplicationCommandData().Options
		itemName := options[0].StringValue()
		quantity := 1
		if len(options) > 1 {
			quantity = int(options[1].IntValue())
		}

		// Ensure user exists
		_, err := client.RegisterUser(user.Username, user.ID)
		if err != nil {
			slog.Error("Failed to register user", "error", err)
			respondError(s, i, "Error connecting to game server.")
			return
		}

		msg, err := client.DisassembleItem(domain.PlatformDiscord, user.ID, user.Username, itemName, quantity)
		if err != nil {
			slog.Error("Failed to disassemble item", "error", err)
			respondFriendlyError(s, i, err.Error())
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ”§ Disassemble Complete",
			Description: msg,
			Color:       0x95a5a6, // Gray
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_economy.go:12: 12-85 lines are duplicate of `internal/discord/cmd_economy.go:88-161` (dupl)
func BuyCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:        "buy",
		Description: "Purchase an item from the shop",
		Options: []*discordgo.ApplicationCommandOption{
			{
				Type:         discordgo.ApplicationCommandOptionString,
				Name:         "item",
				Description:  "Item name to buy",
				Required:     true,
				Autocomplete: true,
			},
			{
				Type:        discordgo.ApplicationCommandOptionInteger,
				Name:        "quantity",
				Description: "Quantity to buy (default: 1)",
				Required:    false,
			},
		},
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		user := i.Member.User
		if user == nil {
			user = i.User
		}

		options := i.ApplicationCommandData().Options
		itemName := options[0].StringValue()
		quantity := 1
		if len(options) > 1 {
			quantity = int(options[1].IntValue())
		}

		// Ensure user exists
		_, err := client.RegisterUser(user.Username, user.ID)
		if err != nil {
			slog.Error("Failed to register user", "error", err)
			respondError(s, i, "Error connecting to game server.")
			return
		}

		msg, err := client.BuyItem(domain.PlatformDiscord, user.ID, user.Username, itemName, quantity)
		if err != nil {
			slog.Error("Failed to buy item", "error", err)
			respondFriendlyError(s, i, err.Error())
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ’° Purchase Complete",
			Description: msg,
			Color:       0x2ecc71, // Green
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_economy.go:88: 88-161 lines are duplicate of `internal/discord/cmd_crafting.go:12-87` (dupl)
func SellCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:        "sell",
		Description: "Sell an item from your inventory",
		Options: []*discordgo.ApplicationCommandOption{
			{
				Type:         discordgo.ApplicationCommandOptionString,
				Name:         "item",
				Description:  "Item name to sell",
				Required:     true,
				Autocomplete: true,
			},
			{
				Type:        discordgo.ApplicationCommandOptionInteger,
				Name:        "quantity",
				Description: "Quantity to sell (default: 1)",
				Required:    false,
			},
		},
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		user := i.Member.User
		if user == nil {
			user = i.User
		}

		options := i.ApplicationCommandData().Options
		itemName := options[0].StringValue()
		quantity := 1
		if len(options) > 1 {
			quantity = int(options[1].IntValue())
		}

		// Ensure user exists
		_, err := client.RegisterUser(user.Username, user.ID)
		if err != nil {
			slog.Error("Failed to register user", "error", err)
			respondError(s, i, "Error connecting to game server.")
			return
		}

		msg, err := client.SellItem(domain.PlatformDiscord, user.ID, user.Username, itemName, quantity)
		if err != nil {
			slog.Error("Failed to sell item", "error", err)
			respondFriendlyError(s, i, err.Error())
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ’µ Sale Complete",
			Description: msg,
			Color:       0xf39c12, // Orange
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_economy.go:164: 164-202 lines are duplicate of `internal/discord/cmd_economy.go:205-243` (dupl)
func PricesCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:        "prices",
		Description: "View buy prices (cost to purchase items)",
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.GetBuyPrices()
		if err != nil {
			slog.Error("Failed to get buy prices", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to get prices: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸª Buy Prices",
			Description: msg,
			Color:       0x3498db, // Blue
			Footer: &discordgo.MessageEmbedFooter{
				Text: "Cost to purchase items",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/cmd_economy.go:205: 205-243 lines are duplicate of `internal/discord/cmd_economy.go:164-202` (dupl)
func SellPricesCommand() (*discordgo.ApplicationCommand, CommandHandler) {
	cmd := &discordgo.ApplicationCommand{
		Name:        "prices-sell",
		Description: "View sell prices (what you get when selling)",
	}

	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.GetSellPrices()
		if err != nil {
			slog.Error("Failed to get sell prices", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to get prices: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ’° Sell Prices",
			Description: msg,
			Color:       0xf1c40f, // Yellow
			Footer: &discordgo.MessageEmbedFooter{
				Text: "Value when selling items",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}

	return cmd, handler
}
internal/discord/client.go:336: 336-366 lines are duplicate of `internal/discord/client.go:369-399` (dupl)
func (c *APIClient) AdminUnlockNode(nodeKey string, level int) (string, error) {
	req := map[string]interface{}{
		"node_key": nodeKey,
		"level":    level,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/progression/admin/unlock", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var unlockResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&unlockResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return unlockResp.Message, nil
}
internal/discord/client.go:369: 369-399 lines are duplicate of `internal/discord/client.go:336-366` (dupl)
func (c *APIClient) AdminRelockNode(nodeKey string, level int) (string, error) {
	req := map[string]interface{}{
		"node_key": nodeKey,
		"level":    level,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/progression/admin/relock", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var relockResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&relockResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return relockResp.Message, nil
}
internal/discord/client.go:642: 642-670 lines are duplicate of `internal/discord/client.go:673-701` (dupl)
func (c *APIClient) GetSellPrices() (string, error) {
	resp, err := c.doRequest(http.MethodGet, "/api/v1/prices", nil)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var pricesResp struct {
		Message string        `json:"message"`
		Items   []domain.Item `json:"items"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&pricesResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	if len(pricesResp.Items) == 0 {
		return "No sellable items available.", nil
	}

	var sb strings.Builder
	for _, item := range pricesResp.Items {
		fmt.Fprintf(&sb, "**%s**: %d coins\n", item.InternalName, item.BaseValue)
	}
	return sb.String(), nil
}
internal/discord/client.go:673: 673-701 lines are duplicate of `internal/discord/client.go:642-670` (dupl)
func (c *APIClient) GetBuyPrices() (string, error) {
	resp, err := c.doRequest(http.MethodGet, "/api/v1/prices/buy", nil)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var pricesResp struct {
		Message string        `json:"message"`
		Items   []domain.Item `json:"items"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&pricesResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	if len(pricesResp.Items) == 0 {
		return "No buyable items available.", nil
	}

	var sb strings.Builder
	for _, item := range pricesResp.Items {
		fmt.Fprintf(&sb, "**%s**: %d coins\n", item.InternalName, item.BaseValue)
	}
	return sb.String(), nil
}
internal/discord/cmd_progression.go:97: 97-133 lines are duplicate of `internal/discord/cmd_progression_extended.go:33-69` (dupl)
	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		options := i.ApplicationCommandData().Options
		nodeKey := options[0].StringValue()
		level := 1
		if len(options) > 1 {
			level = int(options[1].IntValue())
		}

		msg, err := client.AdminUnlockNode(nodeKey, level)
		if err != nil {
			slog.Error("Failed to unlock node", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to unlock: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ”“ Admin Unlock",
			Description: msg,
			Color:       0xe67e22, // Orange
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot Admin",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}
internal/discord/cmd_progression_extended.go:33: 33-69 lines are duplicate of `internal/discord/cmd_progression.go:97-133` (dupl)
	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		options := i.ApplicationCommandData().Options
		nodeKey := options[0].StringValue()
		level := 0
		if len(options) > 1 {
			level = int(options[1].IntValue())
		}

		msg, err := client.AdminRelockNode(nodeKey, level)
		if err != nil {
			slog.Error("Failed to relock node", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to relock: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ”’ Admin Relock",
			Description: msg,
			Color:       0x95a5a6, // Grey
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot Admin",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}
internal/discord/client.go:606: 606-639 lines are duplicate of `internal/discord/client.go:849-882` (dupl)
func (c *APIClient) SellItem(platform, platformID, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"item_name":   itemName,
		"quantity":    quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/sell", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var sellResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&sellResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return sellResp.Message, nil
}
internal/discord/client.go:885: 885-918 lines are duplicate of `internal/discord/client.go:570-603` (dupl)
func (c *APIClient) DisassembleItem(platform, platformID, username, itemName string, quantity int) (string, error) {
	req := map[string]interface{}{
		"platform":    platform,
		"platform_id": platformID,
		"username":    username,
		"item_name":   itemName,
		"quantity":    quantity,
	}

	resp, err := c.doRequest(http.MethodPost, "/api/v1/user/item/disassemble", req)
	if err != nil {
		return "", err
	}
	defer resp.Body.Close()

	if resp.StatusCode != http.StatusOK {
		var errResp struct {
			Error string `json:"error"`
		}
		if err := json.NewDecoder(resp.Body).Decode(&errResp); err == nil && errResp.Error != "" {
			return "", fmt.Errorf("API error: %s", errResp.Error)
		}
		return "", fmt.Errorf("API returned status: %d", resp.StatusCode)
	}

	var disassembleResp struct {
		Message string `json:"message"`
	}
	if err := json.NewDecoder(resp.Body).Decode(&disassembleResp); err != nil {
		return "", fmt.Errorf("failed to decode response: %w", err)
	}

	return disassembleResp.Message, nil
}
internal/discord/cmd_economy.go:170: 170-199 lines are duplicate of `internal/discord/cmd_economy.go:211-240` (dupl)
	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.GetBuyPrices()
		if err != nil {
			slog.Error("Failed to get buy prices", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to get prices: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸª Buy Prices",
			Description: msg,
			Color:       0x3498db, // Blue
			Footer: &discordgo.MessageEmbedFooter{
				Text: "Cost to purchase items",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}
internal/discord/cmd_economy.go:211: 211-240 lines are duplicate of `internal/discord/cmd_progression_extended.go:82-111` (dupl)
	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.GetSellPrices()
		if err != nil {
			slog.Error("Failed to get sell prices", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to get prices: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "ðŸ’° Sell Prices",
			Description: msg,
			Color:       0xf1c40f, // Yellow
			Footer: &discordgo.MessageEmbedFooter{
				Text: "Value when selling items",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}
internal/discord/cmd_progression_extended.go:82: 82-111 lines are duplicate of `internal/discord/cmd_economy.go:170-199` (dupl)
	handler := func(s *discordgo.Session, i *discordgo.InteractionCreate, client *APIClient) {
		if err := s.InteractionRespond(i.Interaction, &discordgo.InteractionResponse{
			Type: discordgo.InteractionResponseDeferredChannelMessageWithSource,
		}); err != nil {
			slog.Error("Failed to send deferred response", "error", err)
			return
		}

		msg, err := client.AdminInstantUnlock()
		if err != nil {
			slog.Error("Failed to instant unlock", "error", err)
			respondError(s, i, fmt.Sprintf("Failed to instant unlock: %v", err))
			return
		}

		embed := &discordgo.MessageEmbed{
			Title:       "âš¡ Admin Instant Resolve",
			Description: msg,
			Color:       0xf1c40f, // Yellow
			Footer: &discordgo.MessageEmbedFooter{
				Text: "BrandishBot Admin",
			},
		}

		if _, err := s.InteractionResponseEdit(i.Interaction, &discordgo.WebhookEdit{
			Embeds: &[]*discordgo.MessageEmbed{embed},
		}); err != nil {
			slog.Error("Failed to send response", "error", err)
		}
	}
internal/database/database.go:25:25: G115: integer overflow conversion int -> int32 (gosec)
	config.MaxConns = int32(maxConns)
	                       ^
internal/lootbox/service_test.go:30:1: cyclomatic complexity 23 of func `TestOpenLootbox` is high (> 15) (gocyclo)
func TestOpenLootbox(t *testing.T) {
^
internal/lootbox/service.go:96:1: cyclomatic complexity 20 of func `(*service).OpenLootbox` is high (> 15) (gocyclo)
func (s *service) OpenLootbox(ctx context.Context, lootboxName string, quantity int) ([]DroppedItem, error) {
^
internal/naming/integration_test.go:22:17: string `../../configs/items/aliases.json` has 3 occurrences, make it a constant (goconst)
	aliasesPath := "../../configs/items/aliases.json"
	               ^
internal/naming/resolver.go:134:19: G404: Use of weak random number generator (math/rand or math/rand/v2 instead of crypto/rand) (gosec)
	alias := aliases[rand.Intn(len(aliases))]
	                 ^
cmd/setup/main.go:16:1: cyclomatic complexity 16 of func `main` is high (> 15) (gocyclo)
func main() {
^
internal/gamble/service.go:321:1: cyclomatic complexity 47 of func `(*service).ExecuteGamble` is high (> 15) (gocyclo)
func (s *service) ExecuteGamble(ctx context.Context, id uuid.UUID) (*domain.GambleResult, error) {
^
internal/gamble/service.go:85:1: cyclomatic complexity 24 of func `(*service).StartGamble` is high (> 15) (gocyclo)
func (s *service) StartGamble(ctx context.Context, platform, platformID, username string, bets []domain.LootboxBet) (*domain.Gamble, error) {
^
internal/gamble/service.go:219:1: cyclomatic complexity 21 of func `(*service).JoinGamble` is high (> 15) (gocyclo)
func (s *service) JoinGamble(ctx context.Context, gambleID uuid.UUID, platform, platformID, username string, bets []domain.LootboxBet) error {
^
internal/handler/progression.go:260: 260-277 lines are duplicate of `internal/handler/progression.go:425-442` (dupl)
func (h *ProgressionHandlers) HandleAdminInstantUnlock() http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		log := logger.FromContext(r.Context())

		unlock, err := h.service.ForceInstantUnlock(r.Context())
		if err != nil {
			log.Error("Failed to instant unlock", "error", err)
			respondError(w, http.StatusInternalServerError, err.Error())
			return
		}

		log.Info("Admin forced instant unlock", "nodeID", unlock.NodeID, "level", unlock.CurrentLevel)
		respondJSON(w, http.StatusOK, AdminInstantUnlockResponse{
			Unlock:  unlock,
			Message: "Instant unlock successful",
		})
	}
}
internal/handler/progression.go:425: 425-442 lines are duplicate of `internal/handler/progression.go:260-277` (dupl)
func (h *ProgressionHandlers) HandleAdminEndVoting() http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		log := logger.FromContext(r.Context())

		winner, err := h.service.EndVoting(r.Context())
		if err != nil {
			log.Error("Failed to end voting", "error", err)
			respondError(w, http.StatusInternalServerError, err.Error())
			return
		}

		log.Info("Admin ended voting", "winningNodeID", winner.NodeID, "votes", winner.VoteCount)
		respondJSON(w, http.StatusOK, AdminEndVotingResponse{
			Winner:  winner,
			Message: "Voting ended successfully",
		})
	}
}
internal/handler/prices.go:18: 18-35 lines are duplicate of `internal/handler/prices.go:45-62` (dupl)
func HandleGetPrices(svc economy.Service) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		log := logger.FromContext(r.Context())

		items, err := svc.GetSellablePrices(r.Context())
		if err != nil {
			log.Error("Failed to get sellable prices", "error", err)
			http.Error(w, err.Error(), http.StatusInternalServerError)
			return
		}

		log.Info("Sellable prices retrieved", "count", len(items))

		w.Header().Set("Content-Type", "application/json")
		w.WriteHeader(http.StatusOK)
		respondJSON(w, http.StatusOK, items)
	}
}
internal/handler/prices.go:45: 45-62 lines are duplicate of `internal/handler/prices.go:18-35` (dupl)
func HandleGetBuyPrices(svc economy.Service) http.HandlerFunc {
	return func(w http.ResponseWriter, r *http.Request) {
		log := logger.FromContext(r.Context())

		items, err := svc.GetBuyablePrices(r.Context())
		if err != nil {
			log.Error("Failed to get buyable prices", "error", err)
			http.Error(w, err.Error(), http.StatusInternalServerError)
			return
		}

		log.Info("Buyable prices retrieved", "count", len(items))

		w.Header().Set("Content-Type", "application/json")
		w.WriteHeader(http.StatusOK)
		respondJSON(w, http.StatusOK, items)
	}
}
internal/job/resilient_events_test.go:36:13: string `user1` has 4 occurrences, make it a constant (goconst)
		userID := "user1"
		          ^
internal/job/service.go:169:1: cyclomatic complexity 16 of func `(*service).AwardXP` is high (> 15) (gocyclo)
func (s *service) AwardXP(ctx context.Context, userID, jobKey string, baseAmount int, source string, metadata map[string]interface{}) (*domain.XPAwardResult, error) {
^
internal/job/service.go:189:19: ineffectual assignment to err (ineffassign)
	currentProgress, err := s.repo.GetUserJob(ctx, userID, job.ID)
	                 ^
internal/cooldown/postgres.go:222:14: G115: integer overflow conversion uint64 -> int64 (gosec)
	return int64(binary.BigEndian.Uint64(h[:8]) & 0x7FFFFFFFFFFFFFFF)
	            ^
internal/database/postgres/progression_junction.go:11: 11-37 lines are duplicate of `internal/database/postgres/progression_junction.go:40-66` (dupl)
func (r *progressionRepository) GetPrerequisites(ctx context.Context, nodeID int) ([]*domain.ProgressionNode, error) {
	rows, err := r.q.GetNodePrerequisites(ctx, int32(nodeID))
	if err != nil {
		return nil, fmt.Errorf("failed to query prerequisites: %w", err)
	}

	var nodes []*domain.ProgressionNode
	for _, row := range rows {
		node := &domain.ProgressionNode{
			ID:          int(row.ID),
			NodeKey:     row.NodeKey,
			NodeType:    row.NodeType,
			DisplayName: row.DisplayName,
			Description: row.Description.String,
			MaxLevel:    int(row.MaxLevel.Int32),
			UnlockCost:  int(row.UnlockCost.Int32),
			Tier:        int(row.Tier),
			Size:        row.Size,
			Category:    row.Category,
			SortOrder:   int(row.SortOrder.Int32),
			CreatedAt:   row.CreatedAt.Time,
		}
		nodes = append(nodes, node)
	}

	return nodes, nil
}
internal/database/postgres/progression_junction.go:40: 40-66 lines are duplicate of `internal/database/postgres/progression_junction.go:11-37` (dupl)
func (r *progressionRepository) GetDependents(ctx context.Context, nodeID int) ([]*domain.ProgressionNode, error) {
	rows, err := r.q.GetNodeDependents(ctx, int32(nodeID))
	if err != nil {
		return nil, fmt.Errorf("failed to query dependents: %w", err)
	}

	var nodes []*domain.ProgressionNode
	for _, row := range rows {
		node := &domain.ProgressionNode{
			ID:          int(row.ID),
			NodeKey:     row.NodeKey,
			NodeType:    row.NodeType,
			DisplayName: row.DisplayName,
			Description: row.Description.String,
			MaxLevel:    int(row.MaxLevel.Int32),
			UnlockCost:  int(row.UnlockCost.Int32),
			Tier:        int(row.Tier),
			Size:        row.Size,
			Category:    row.Category,
			SortOrder:   int(row.SortOrder.Int32),
			CreatedAt:   row.CreatedAt.Time,
		}
		nodes = append(nodes, node)
	}

	return nodes, nil
}
internal/database/postgres/stats.go:84: 84-104 lines are duplicate of `internal/database/postgres/stats.go:126-146` (dupl)
	for _, row := range rows {
		var eventData map[string]interface{}
		if len(row.EventData) > 0 {
			if err := json.Unmarshal(row.EventData, &eventData); err != nil {
				return nil, fmt.Errorf("failed to unmarshal event data: %w", err)
			}
		}

		var uid uuid.UUID
		if row.UserID.Valid {
			uid = [16]byte(row.UserID.Bytes)
		}

		events = append(events, domain.StatsEvent{
			EventID:   row.EventID,
			UserID:    uid.String(),
			EventType: domain.EventType(row.EventType),
			EventData: eventData,
			CreatedAt: row.CreatedAt.Time,
		})
	}
internal/database/postgres/stats.go:126: 126-146 lines are duplicate of `internal/database/postgres/stats.go:163-183` (dupl)
	for _, row := range rows {
		var eventData map[string]interface{}
		if len(row.EventData) > 0 {
			if err := json.Unmarshal(row.EventData, &eventData); err != nil {
				return nil, fmt.Errorf("failed to unmarshal event data: %w", err)
			}
		}

		var uid uuid.UUID
		if row.UserID.Valid {
			uid = [16]byte(row.UserID.Bytes)
		}

		events = append(events, domain.StatsEvent{
			EventID:   row.EventID,
			UserID:    uid.String(),
			EventType: domain.EventType(row.EventType),
			EventData: eventData,
			CreatedAt: row.CreatedAt.Time,
		})
	}
internal/database/postgres/stats.go:163: 163-183 lines are duplicate of `internal/database/postgres/stats.go:84-104` (dupl)
	for _, row := range rows {
		var eventData map[string]interface{}
		if len(row.EventData) > 0 {
			if err := json.Unmarshal(row.EventData, &eventData); err != nil {
				return nil, fmt.Errorf("failed to unmarshal event data: %w", err)
			}
		}

		var uid uuid.UUID
		if row.UserID.Valid {
			uid = [16]byte(row.UserID.Bytes)
		}

		events = append(events, domain.StatsEvent{
			EventID:   row.EventID,
			UserID:    uid.String(),
			EventType: domain.EventType(row.EventType),
			EventData: eventData,
			CreatedAt: row.CreatedAt.Time,
		})
	}
internal/database/postgres/user.go:179: 179-213 lines are duplicate of `internal/database/postgres/user.go:216-250` (dupl)
func (r *UserRepository) GetUserByPlatformID(ctx context.Context, platform, platformID string) (*domain.User, error) {
	row, err := r.q.GetUserByPlatformID(ctx, generated.GetUserByPlatformIDParams{
		Name:           platform,
		PlatformUserID: platformID,
	})
	if err != nil {
		if err == pgx.ErrNoRows {
			return nil, domain.ErrUserNotFound
		}
		return nil, fmt.Errorf("failed to get user core data: %w", err)
	}

	user := domain.User{
		ID:       row.UserID.String(),
		Username: row.Username,
	}

	links, err := r.q.GetUserPlatformLinks(ctx, row.UserID)
	if err != nil {
		return nil, fmt.Errorf("failed to get user links: %w", err)
	}

	for _, link := range links {
		switch link.Name {
		case "twitch":
			user.TwitchID = link.PlatformUserID
		case "youtube":
			user.YoutubeID = link.PlatformUserID
		case "discord":
			user.DiscordID = link.PlatformUserID
		}
	}

	return &user, nil
}
internal/database/postgres/user.go:216: 216-250 lines are duplicate of `internal/database/postgres/user.go:179-213` (dupl)
func (r *UserRepository) GetUserByPlatformUsername(ctx context.Context, platform, username string) (*domain.User, error) {
	row, err := r.q.GetUserByPlatformUsername(ctx, generated.GetUserByPlatformUsernameParams{
		Lower: username,
		Name:  platform,
	})
	if err != nil {
		if err == pgx.ErrNoRows {
			return nil, domain.ErrUserNotFound
		}
		return nil, fmt.Errorf("failed to get user by username: %w", err)
	}

	user := domain.User{
		ID:       row.UserID.String(),
		Username: row.Username,
	}

	links, err := r.q.GetUserPlatformLinks(ctx, row.UserID)
	if err != nil {
		return nil, fmt.Errorf("failed to get user links: %w", err)
	}

	for _, link := range links {
		switch link.Name {
		case "twitch":
			user.TwitchID = link.PlatformUserID
		case "youtube":
			user.YoutubeID = link.PlatformUserID
		case "discord":
			user.DiscordID = link.PlatformUserID
		}
	}

	return &user, nil
}
internal/database/postgres/gamble.go:174:19: Error return value of `tx.Rollback` is not checked (errcheck)
	defer tx.Rollback(ctx)
	                 ^
internal/database/postgres/user.go:203:8: string `twitch` has 3 occurrences, make it a constant (goconst)
		case "twitch":
		     ^
internal/database/postgres/user.go:207:8: string `discord` has 5 occurrences, make it a constant (goconst)
		case "discord":
		     ^
internal/database/postgres/user.go:205:8: string `youtube` has 3 occurrences, make it a constant (goconst)
		case "youtube":
		     ^
internal/database/postgres/progression_integration_test.go:16:1: cyclomatic complexity 78 of func `TestProgressionRepository_Integration` is high (> 15) (gocyclo)
func TestProgressionRepository_Integration(t *testing.T) {
^
internal/database/postgres/integration_test.go:21:1: cyclomatic complexity 67 of func `TestUserRepository_Integration` is high (> 15) (gocyclo)
func TestUserRepository_Integration(t *testing.T) {
^
internal/database/postgres/stats_integration_test.go:15:1: cyclomatic complexity 53 of func `TestStatsRepository_Integration` is high (> 15) (gocyclo)
func TestStatsRepository_Integration(t *testing.T) {
^
internal/database/postgres/user_service_integration_test.go:463:1: cyclomatic complexity 29 of func `TestUsernameBasedMethods_Integration` is high (> 15) (gocyclo)
func TestUsernameBasedMethods_Integration(t *testing.T) {
^
internal/database/postgres/linking_integration_test.go:15:1: cyclomatic complexity 29 of func `TestLinkingRepository_Integration` is high (> 15) (gocyclo)
func TestLinkingRepository_Integration(t *testing.T) {
^
internal/database/postgres/user_service_integration_test.go:212:1: cyclomatic complexity 22 of func `TestUserService_InventoryOperations_Integration` is high (> 15) (gocyclo)
func TestUserService_InventoryOperations_Integration(t *testing.T) {
^
internal/database/postgres/concurrency_integration_test.go:19:1: cyclomatic complexity 19 of func `TestConcurrentAddItem_Integration` is high (> 15) (gocyclo)
func TestConcurrentAddItem_Integration(t *testing.T) {
^
internal/database/postgres/eventlog.go:60:15: G115: integer overflow conversion int -> int32 (gosec)
		Limit: int32(filter.Limit),
		            ^
internal/database/postgres/eventlog.go:108:16: G115: integer overflow conversion int -> int32 (gosec)
		Limit:  int32(limit),
		             ^
internal/database/postgres/eventlog.go:130:19: G115: integer overflow conversion int -> int32 (gosec)
		Limit:     int32(limit),
		                ^
internal/database/postgres/eventlog.go:150:40: G115: integer overflow conversion int -> int32 (gosec)
	return r.q.CleanupOldEvents(ctx, int32(retentionDays))
	                                      ^
internal/database/postgres/gamble.go:187:38: G115: integer overflow conversion int -> int32 (gosec)
			ItemID:   pgtype.Int4{Int32: int32(item.ItemID), Valid: true},
			                                  ^
internal/database/postgres/gamble.go:291:38: G115: integer overflow conversion int -> int32 (gosec)
			ItemID:   pgtype.Int4{Int32: int32(item.ItemID), Valid: true},
			                                  ^
internal/database/postgres/job.go:110:16: G115: integer overflow conversion int -> int32 (gosec)
		JobID:  int32(jobID),
		             ^
internal/database/postgres/job.go:144:23: G115: integer overflow conversion int -> int32 (gosec)
		JobID:         int32(userJob.JobID),
		                    ^
internal/database/postgres/job.go:146:23: G115: integer overflow conversion int -> int32 (gosec)
		CurrentLevel:  int32(userJob.CurrentLevel),
		                    ^
internal/database/postgres/job.go:174:24: G115: integer overflow conversion int -> int32 (gosec)
		JobID:          int32(event.JobID),
		                     ^
internal/database/postgres/job.go:175:24: G115: integer overflow conversion int -> int32 (gosec)
		XpAmount:       int32(event.XPAmount),
		                     ^
internal/database/postgres/job.go:192:18: G115: integer overflow conversion int -> int32 (gosec)
		JobID:    int32(jobID),
		               ^
internal/database/postgres/job.go:193:18: G115: integer overflow conversion int -> int32 (gosec)
		MinLevel: int32(level),
		               ^
internal/database/postgres/progression.go:59:41: G115: integer overflow conversion int -> int32 (gosec)
	node, err := r.q.GetNodeByID(ctx, int32(id))
	                                       ^
internal/database/postgres/progression.go:125:40: G115: integer overflow conversion int -> int32 (gosec)
		MaxLevel:    pgtype.Int4{Int32: int32(node.MaxLevel), Valid: true},
		                                     ^
internal/database/postgres/progression.go:126:40: G115: integer overflow conversion int -> int32 (gosec)
		UnlockCost:  pgtype.Int4{Int32: int32(node.UnlockCost), Valid: true},
		                                     ^
internal/database/postgres/progression.go:127:21: G115: integer overflow conversion int -> int32 (gosec)
		Tier:        int32(node.Tier),
		                  ^
internal/database/postgres/progression.go:130:40: G115: integer overflow conversion int -> int32 (gosec)
		SortOrder:   pgtype.Int4{Int32: int32(node.SortOrder), Valid: true},
		                                     ^
internal/database/postgres/progression.go:144:21: G115: integer overflow conversion int -> int32 (gosec)
		ID:          int32(nodeID),
		                  ^
internal/database/postgres/progression.go:148:40: G115: integer overflow conversion int -> int32 (gosec)
		MaxLevel:    pgtype.Int4{Int32: int32(node.MaxLevel), Valid: true},
		                                     ^
internal/database/postgres/progression.go:149:40: G115: integer overflow conversion int -> int32 (gosec)
		UnlockCost:  pgtype.Int4{Int32: int32(node.UnlockCost), Valid: true},
		                                     ^
internal/database/postgres/progression.go:150:21: G115: integer overflow conversion int -> int32 (gosec)
		Tier:        int32(node.Tier),
		                  ^
internal/database/postgres/progression.go:153:40: G115: integer overflow conversion int -> int32 (gosec)
		SortOrder:   pgtype.Int4{Int32: int32(node.SortOrder), Valid: true},
		                                     ^
internal/database/postgres/progression.go:167:41: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:       pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                      ^
internal/database/postgres/progression.go:168:41: G115: integer overflow conversion int -> int32 (gosec)
		CurrentLevel: pgtype.Int4{Int32: int32(level), Valid: true},
		                                      ^
internal/database/postgres/progression.go:212:41: G115: integer overflow conversion int -> int32 (gosec)
		CurrentLevel: pgtype.Int4{Int32: int32(level), Valid: true},
		                                      ^
internal/database/postgres/progression.go:218:44: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:          pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                         ^
internal/database/postgres/progression.go:219:44: G115: integer overflow conversion int -> int32 (gosec)
		CurrentLevel:    pgtype.Int4{Int32: int32(level), Valid: true},
		                                         ^
internal/database/postgres/progression.go:221:44: G115: integer overflow conversion int -> int32 (gosec)
		EngagementScore: pgtype.Int4{Int32: int32(engagementScore), Valid: true},
		                                         ^
internal/database/postgres/progression.go:233:41: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:       pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                      ^
internal/database/postgres/progression.go:234:41: G115: integer overflow conversion int -> int32 (gosec)
		CurrentLevel: pgtype.Int4{Int32: int32(level), Valid: true},
		                                      ^
internal/database/postgres/progression.go:280:41: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:       pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                      ^
internal/database/postgres/progression.go:281:41: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel:  pgtype.Int4{Int32: int32(level), Valid: true},
		                                      ^
internal/database/postgres/progression.go:294:40: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:      pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                     ^
internal/database/postgres/progression.go:295:40: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel: pgtype.Int4{Int32: int32(level), Valid: true},
		                                     ^
internal/database/postgres/progression.go:323:40: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:      pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                     ^
internal/database/postgres/progression.go:324:40: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel: pgtype.Int4{Int32: int32(level), Valid: true},
		                                     ^
internal/database/postgres/progression.go:336:40: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:      pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                     ^
internal/database/postgres/progression.go:337:40: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel: pgtype.Int4{Int32: int32(level), Valid: true},
		                                     ^
internal/database/postgres/progression.go:352:21: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:      int32(nodeID),
		                  ^
internal/database/postgres/progression.go:353:21: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel: int32(level),
		                  ^
internal/database/postgres/progression.go:360:21: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:      int32(nodeID),
		                  ^
internal/database/postgres/progression.go:361:21: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel: int32(level),
		                  ^
internal/database/postgres/progression.go:450:40: G115: integer overflow conversion int -> int32 (gosec)
		MetricValue: pgtype.Int4{Int32: int32(metric.MetricValue), Valid: true},
		                                     ^
internal/database/postgres/progression.go:581:51: G115: integer overflow conversion int64 -> int32 (gosec)
		NodesResetCount:        pgtype.Int4{Int32: int32(nodeCount), Valid: true},
		                                                ^
internal/database/postgres/progression.go:582:51: G115: integer overflow conversion int64 -> int32 (gosec)
		EngagementScoreAtReset: pgtype.Int4{Int32: int32(engagementScore), Valid: true},
		                                                ^
internal/database/postgres/progression.go:617:51: G115: integer overflow conversion int -> int32 (gosec)
		NodesResetCount:        pgtype.Int4{Int32: int32(reset.NodesResetCount), Valid: true},
		                                                ^
internal/database/postgres/progression.go:618:51: G115: integer overflow conversion int -> int32 (gosec)
		EngagementScoreAtReset: pgtype.Int4{Int32: int32(reset.EngagementScoreAtReset), Valid: true},
		                                                ^
internal/database/postgres/progression_junction.go:12:50: G115: integer overflow conversion int -> int32 (gosec)
	rows, err := r.q.GetNodePrerequisites(ctx, int32(nodeID))
	                                                ^
internal/database/postgres/progression_junction.go:41:47: G115: integer overflow conversion int -> int32 (gosec)
	rows, err := r.q.GetNodeDependents(ctx, int32(nodeID))
	                                             ^
internal/database/postgres/progression_leaderboard.go:12:56: G115: integer overflow conversion int -> int32 (gosec)
	rows, err := r.q.GetContributionLeaderboard(ctx, int32(limit))
	                                                      ^
internal/database/postgres/progression_prerequisites.go:22:43: G115: integer overflow conversion int -> int32 (gosec)
	err = q.ClearNodePrerequisites(ctx, int32(nodeID))
	                                         ^
internal/database/postgres/progression_prerequisites.go:30:29: G115: integer overflow conversion int -> int32 (gosec)
			NodeID:             int32(nodeID),
			                         ^
internal/database/postgres/progression_prerequisites.go:31:29: G115: integer overflow conversion int -> int32 (gosec)
			PrerequisiteNodeID: int32(prereqID),
			                         ^
internal/database/postgres/progression_sessions.go:26:21: G115: integer overflow conversion int -> int32 (gosec)
		SessionID:   int32(sessionID),
		                  ^
internal/database/postgres/progression_sessions.go:27:21: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:      int32(nodeID),
		                  ^
internal/database/postgres/progression_sessions.go:28:21: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel: int32(targetLevel),
		                  ^
internal/database/postgres/progression_sessions.go:75:43: G115: integer overflow conversion int -> int32 (gosec)
	row, err := r.q.GetSessionByID(ctx, int32(sessionID))
	                                         ^
internal/database/postgres/progression_sessions.go:109:47: G115: integer overflow conversion int -> int32 (gosec)
	rows, err := r.q.GetSessionOptions(ctx, int32(sessionID))
	                                             ^
internal/database/postgres/progression_sessions.go:139:43: G115: integer overflow conversion int -> int32 (gosec)
	err := r.q.IncrementOptionVote(ctx, int32(optionID))
	                                         ^
internal/database/postgres/progression_sessions.go:145:46: G115: integer overflow conversion int -> int32 (gosec)
	err = r.q.UpdateOptionLastHighest(ctx, int32(optionID))
	                                            ^
internal/database/postgres/progression_sessions.go:151:25: G115: integer overflow conversion int -> int32 (gosec)
		ID:              int32(sessionID),
		                      ^
internal/database/postgres/progression_sessions.go:152:44: G115: integer overflow conversion int -> int32 (gosec)
		WinningOptionID: pgtype.Int4{Int32: int32(winningOptionID), Valid: true},
		                                         ^
internal/database/postgres/progression_sessions.go:163:65: G115: integer overflow conversion int -> int32 (gosec)
	rows, err := r.q.GetSessionVoters(ctx, pgtype.Int4{Int32: int32(sessionID), Valid: true})
	                                                               ^
internal/database/postgres/progression_sessions.go:179:38: G115: integer overflow conversion int -> int32 (gosec)
		SessionID: pgtype.Int4{Int32: int32(sessionID), Valid: true},
		                                   ^
internal/database/postgres/progression_sessions.go:186:38: G115: integer overflow conversion int -> int32 (gosec)
		SessionID: pgtype.Int4{Int32: int32(sessionID), Valid: true},
		                                   ^
internal/database/postgres/progression_sessions.go:187:38: G115: integer overflow conversion int -> int32 (gosec)
		OptionID:  pgtype.Int4{Int32: int32(optionID), Valid: true},
		                                   ^
internal/database/postgres/progression_sessions.go:188:19: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:    int32(nodeID),
		                ^
internal/database/postgres/progression_sessions.go:247:34: G115: integer overflow conversion int -> int32 (gosec)
		ID:                       int32(progressID),
		                               ^
internal/database/postgres/progression_sessions.go:248:34: G115: integer overflow conversion int -> int32 (gosec)
		ContributionsAccumulated: int32(amount),
		                               ^
internal/database/postgres/progression_sessions.go:258:25: G115: integer overflow conversion int -> int32 (gosec)
		ID:              int32(progressID),
		                      ^
internal/database/postgres/progression_sessions.go:259:44: G115: integer overflow conversion int -> int32 (gosec)
		NodeID:          pgtype.Int4{Int32: int32(nodeID), Valid: true},
		                                         ^
internal/database/postgres/progression_sessions.go:260:44: G115: integer overflow conversion int -> int32 (gosec)
		TargetLevel:     pgtype.Int4{Int32: int32(targetLevel), Valid: true},
		                                         ^
internal/database/postgres/progression_sessions.go:261:44: G115: integer overflow conversion int -> int32 (gosec)
		VotingSessionID: pgtype.Int4{Int32: int32(sessionID), Valid: true},
		                                         ^
internal/database/postgres/progression_sessions.go:273:38: G115: integer overflow conversion int -> int32 (gosec)
	err := r.q.CompleteUnlock(ctx, int32(progressID))
	                                    ^
internal/database/postgres/progression_sessions.go:279:55: G115: integer overflow conversion int -> int32 (gosec)
	newID, err := r.q.InsertNextUnlockProgress(ctx, int32(rolloverPoints))
	                                                     ^
internal/database/postgres/stats.go:119:19: G115: integer overflow conversion int -> int32 (gosec)
		Limit:     int32(limit),
		                ^
internal/database/postgres/stats.go:194:21: G115: integer overflow conversion int -> int32 (gosec)
		Limit:       int32(limit),
		                  ^
internal/database/postgres/user.go:356:17: G115: integer overflow conversion int -> int32 (gosec)
		ids[i] = int32(id)
		              ^
internal/database/postgres/user.go:409:40: G115: integer overflow conversion int -> int32 (gosec)
	row, err := r.q.GetItemByID(ctx, int32(id))
	                                      ^
internal/database/postgres/user.go:474:52: G115: integer overflow conversion int -> int32 (gosec)
	row, err := r.q.GetRecipeByTargetItemID(ctx, int32(itemID))
	                                                  ^
internal/database/postgres/user.go:509:18: G115: integer overflow conversion int -> int32 (gosec)
		RecipeID: int32(recipeID),
		               ^
internal/database/postgres/user.go:521:18: G115: integer overflow conversion int -> int32 (gosec)
		RecipeID: int32(recipeID),
		               ^
internal/database/postgres/user.go:570:63: G115: integer overflow conversion int -> int32 (gosec)
	row, err := r.q.GetDisassembleRecipeBySourceItemID(ctx, int32(itemID))
	                                                             ^
internal/database/postgres/user.go:602:56: G115: integer overflow conversion int -> int32 (gosec)
	id, err := r.q.GetAssociatedUpgradeRecipeID(ctx, int32(disassembleRecipeID))
	                                                      ^
internal/database/postgres/progression_sessions.go:169:2: S1011: should replace loop with `voters = append(voters, rows...)` (gosimple)
	for _, userID := range rows {
	^
internal/linking/service.go:158:21: Error return value of `s.repo.UpdateToken` is not checked (errcheck)
		s.repo.UpdateToken(ctx, token)
		                  ^
internal/linking/service.go:193:21: Error return value of `s.repo.UpdateToken` is not checked (errcheck)
		s.repo.UpdateToken(ctx, token)
		                  ^
internal/linking/service.go:226:21: Error return value of `s.repo.UpdateToken` is not checked (errcheck)
		s.repo.UpdateToken(ctx, token)
		                  ^
internal/linking/service.go:242:20: Error return value of `s.repo.UpdateToken` is not checked (errcheck)
	s.repo.UpdateToken(ctx, token)
	                  ^
internal/linking/service_test.go:140:25: string `discord-123` has 3 occurrences, make it a constant (goconst)
		return u.DiscordID == "discord-123"
		                      ^
internal/user/linking.go:15:1: cyclomatic complexity 23 of func `(*service).MergeUsers` is high (> 15) (gocyclo)
func (s *service) MergeUsers(ctx context.Context, primaryUserID, secondaryUserID string) error {
^
internal/user/service_test.go:407:1: cyclomatic complexity 21 of func `TestGetInventory` is high (> 15) (gocyclo)
func TestGetInventory(t *testing.T) {
^
internal/user/service.go:559:1: cyclomatic complexity 16 of func `(*service).AddItems` is high (> 15) (gocyclo)
func (s *service) AddItems(ctx context.Context, platform, platformID, username string, items map[string]int) error {
^
internal/user/search_test.go:787:2: ineffectual assignment to msg (ineffassign)
	msg, err = svc.HandleSearch(ctx, domain.PlatformTwitch, "testuser123", TestUsername)
	^
internal/economy/service_test.go:360:100: string `over max boundary` has 3 occurrences, make it a constant (goconst)
			if !tt.expectErr || (tt.name != "negative quantity" && tt.name != "zero quantity" && tt.name != "over max boundary") {
			                                                                                                ^
